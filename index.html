<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OBS Character Bar</title>
<style>
  body {
    margin: 0;
    font-family: sans-serif;
    background: transparent;
    color: white;
  }

  #pd-container {
    width: 300px;      /* adjust as needed */
    height: 30px;
    border: 2px solid #fff;
    border-radius: 5px;
    position: relative;
    overflow: hidden;
    background-color: rgba(255,255,255,0.1);
  }

  #pd-bar {
    height: 100%;
    width: 0%;
    background-color: red;
    transition: width 0.3s;
  }

  #pd-text {
    position: absolute;
    width: 100%;
    text-align: center;
    top: 50%;
    transform: translateY(-50%);
    font-weight: bold;
  }
</style>
</head>
<body>
  <div id="pd-container">
    <div id="pd-bar"></div>
    <div id="pd-text">Loading...</div>
  </div>

<script>
const url = "https://firestore.googleapis.com/v1/projects/cris-ordem-paranormal/databases/(default)/documents/characters/vuLkqu9FPmrIZ4iTIhKE";

async function updatePd() {
    try {
        const res = await fetch(url);
        const data = await res.json();

        // Firestore stores values under fields
        const currentPd = parseInt(data.fields.currentPd.integerValue);
        const maxPd = parseInt(data.fields.maxPd.integerValue);

        // Update text
        document.getElementById("pd-text").innerText = `${currentPd} / ${maxPd}`;

        // Update bar width
        const percentage = (currentPd / maxPd) * 100;
        document.getElementById("pd-bar").style.width = percentage + "%";

    } catch (err) {
        console.error("Error fetching PD:", err);
        document.getElementById("pd-text").innerText = "Error";
        document.getElementById("pd-bar").style.width = "0%";
    }
}

// Initial fetch
updatePd();

// Refresh every 5 seconds
setInterval(updatePd, 5000);
</script>
</body>
</html>
